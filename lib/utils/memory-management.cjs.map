{"version":3,"file":"memory-management.cjs","sources":["../../src/utils/memory-management.ts"],"sourcesContent":["/**\n * @ldesign/engine 内存管理工具集\n * \n * 统一导出所有内存管理相关的工具\n */\n\n// 内存监控与资源管理\nimport { MemoryMonitor } from './memory-monitor';\nimport { ResourceManager } from './resource-manager';\n\nexport { MemoryMonitor } from './memory-monitor';\nexport type {\n  MemoryError,\n  MemoryMonitorConfig,\n  MemoryStats,\n  MemoryWarning\n} from './memory-monitor';\nexport { ResourceManager } from './resource-manager';\n\n/**\n * 创建带资源管理的应用上下文\n */\nexport function createManagedContext() {\n  const resources = new ResourceManager();\n  const memoryMonitor = new MemoryMonitor({\n    autoStart: true,\n    onWarning: (info: any) => {\n      console.warn('[Memory Warning]', info.message);\n    },\n    onError: (info: any) => {\n      console.error('[Memory Error]', info.message);\n    }\n  });\n  \n  return {\n    resources,\n    memoryMonitor,\n    \n    /**\n     * 清理所有资源\n     */\n    destroy() {\n      memoryMonitor.destroy();\n      resources.destroy();\n    },\n    \n    /**\n     * 获取统计信息\n     */\n    getStats() {\n      return {\n        memory: memoryMonitor.getStats(),\n        resources: resources.getStats()\n      };\n    }\n  };\n}\n\n/**\n * 全局资源管理器（可选使用）\n */\nlet globalContext: ReturnType<typeof createManagedContext> | null = null;\n\n/**\n * 获取全局资源管理上下文\n */\nexport function getGlobalContext() {\n  if (!globalContext) {\n    globalContext = createManagedContext();\n  }\n  return globalContext;\n}\n\n/**\n * 销毁全局资源管理上下文\n */\nexport function destroyGlobalContext() {\n  if (globalContext) {\n    globalContext.destroy();\n    globalContext = null;\n  }\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"names":["ResourceManager","memoryMonitor","MemoryMonitor"],"mappings":";;;;;;;;;;;;;;SAsBgB,oBAAA,GAAoB;AAClC,EAAA,MAAM,SAAA,GAAY,IAAIA,+BAAA;AACtB,EAAA,MAAMC,eAAA,GAAgB,IAAIC,2BAAA,CAAc;AAAA,IACtC,SAAA,EAAW,IAAA;AAAA,IACX,SAAA,EAAW,CAAC,IAAA,KAAa;AACvB,MAAA,OAAA,CAAQ,IAAA,CAAK,kBAAA,EAAoB,IAAA,CAAK,OAAO,CAAA;AAAA,IAC/C,CAAA;AAAA,IACA,OAAA,EAAS,CAAC,IAAA,KAAa;AACrB,MAAA,OAAA,CAAQ,KAAA,CAAM,gBAAA,EAAkB,IAAA,CAAK,OAAO,CAAA;AAAA,IAC9C;AAAA,GACD,CAAA;AAED,EAAA,OAAO;AAAA,IACL,SAAA;AAAA,mBACAD,eAAA;AAAA;AAAA;AAAA;AAAA,IAKA,OAAA,GAAO;AACL,MAAAA,eAAA,CAAc,OAAA,EAAO;AACrB,MAAA,SAAA,CAAU,OAAA,EAAO;AAAA,IACnB,CAAA;AAAA;AAAA;AAAA;AAAA,IAKA,QAAA,GAAQ;AACN,MAAA,OAAO;AAAA,QACL,MAAA,EAAQA,gBAAc,QAAA,EAAQ;AAAA,QAC9B,SAAA,EAAW,UAAU,QAAA;AAAQ;IAEjC;AAAA;AAEJ;AAKA,IAAI,aAAA,GAAgE,IAAA;SAKpD,gBAAA,GAAgB;AAC9B,EAAA,IAAI,CAAC,aAAA,EAAe;AAClB,IAAA,aAAA,GAAgB,oBAAA,EAAoB;AAAA,EACtC;AACA,EAAA,OAAO,aAAA;AACT;SAKgB,oBAAA,GAAoB;AAClC,EAAA,IAAI,aAAA,EAAe;AACjB,IAAA,aAAA,CAAc,OAAA,EAAO;AACrB,IAAA,aAAA,GAAgB,IAAA;AAAA,EAClB;AACF;;;;;;;;"}