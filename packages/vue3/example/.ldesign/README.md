# å¤šç¯å¢ƒé…ç½®è¯´æ˜

æœ¬é¡¹ç›®å·²é…ç½®å¤šç¯å¢ƒæ”¯æŒï¼Œå¯ä»¥ä¸ºä¸åŒç¯å¢ƒï¼ˆå¼€å‘ã€ç”Ÿäº§ã€æµ‹è¯•ã€é¢„å‘å¸ƒï¼‰ä½¿ç”¨ä¸åŒçš„é…ç½®ã€‚

## ğŸ“ é…ç½®æ–‡ä»¶ç»“æ„

```
.ldesign/
â”œâ”€â”€ launcher.config.ts              # Launcher åŸºç¡€é…ç½®ï¼ˆæ‰€æœ‰ç¯å¢ƒå…±äº«ï¼‰
â”œâ”€â”€ launcher.config.development.ts  # Launcher å¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ launcher.config.production.ts   # Launcher ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ launcher.config.test.ts         # Launcher æµ‹è¯•ç¯å¢ƒé…ç½®
â”œâ”€â”€ launcher.config.staging.ts      # Launcher é¢„å‘å¸ƒç¯å¢ƒé…ç½®
â”œâ”€â”€ app.config.ts                   # App åŸºç¡€é…ç½®ï¼ˆæ‰€æœ‰ç¯å¢ƒå…±äº«ï¼‰
â”œâ”€â”€ app.config.development.ts       # App å¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ app.config.production.ts        # App ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ app.config.test.ts              # App æµ‹è¯•ç¯å¢ƒé…ç½®
â””â”€â”€ app.config.staging.ts          # App é¢„å‘å¸ƒç¯å¢ƒé…ç½®
```

## ğŸ”§ ç¯å¢ƒé…ç½®å·®å¼‚

### ç«¯å£é…ç½®

| ç¯å¢ƒ | å¼€å‘æœåŠ¡å™¨ç«¯å£ | é¢„è§ˆæœåŠ¡å™¨ç«¯å£ |
|------|--------------|--------------|
| **å¼€å‘ (development)** | 5174 | 4174 |
| **ç”Ÿäº§ (production)** | 5175 | 4175 |
| **æµ‹è¯• (test)** | 5176 | 4176 |
| **é¢„å‘å¸ƒ (staging)** | 5177 | 4177 |

### è¾“å‡ºç›®å½•é…ç½®

| ç¯å¢ƒ | æ„å»ºè¾“å‡ºç›®å½• | ç¼“å­˜ç›®å½• |
|------|------------|---------|
| **å¼€å‘ (development)** | `dist-dev` | `node_modules/.vite-dev` |
| **ç”Ÿäº§ (production)** | `dist-prod` | `node_modules/.vite-prod` |
| **æµ‹è¯• (test)** | `dist-test` | `node_modules/.vite-test` |
| **é¢„å‘å¸ƒ (staging)** | `dist-staging` | `node_modules/.vite-staging` |

### App é…ç½®å·®å¼‚

| é…ç½®é¡¹ | å¼€å‘ | ç”Ÿäº§ | æµ‹è¯• | é¢„å‘å¸ƒ |
|--------|------|------|------|--------|
| **API åœ°å€** | localhost:8080 | api.example.com | localhost:3001 | staging-api.example.com |
| **è°ƒè¯•æ¨¡å¼** | âœ… å¼€å¯ | âŒ å…³é—­ | âœ… å¼€å¯ | âŒ å…³é—­ |
| **åˆ†æç»Ÿè®¡** | âŒ å…³é—­ | âœ… å¼€å¯ | âŒ å…³é—­ | âœ… å¼€å¯ |
| **é…ç½®é¢æ¿** | âœ… æ˜¾ç¤º | âŒ éšè— | âœ… æ˜¾ç¤º | âœ… æ˜¾ç¤º |
| **çƒ­æ›´æ–°** | âœ… å¼€å¯ | âŒ å…³é—­ | âŒ å…³é—­ | âŒ å…³é—­ |

### é…ç½®ç‰¹æ€§å¯¹æ¯”

| ç‰¹æ€§ | å¼€å‘ | ç”Ÿäº§ | æµ‹è¯• | é¢„å‘å¸ƒ |
|------|------|------|------|--------|
| **è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨** | âœ… | âŒ | âŒ | âŒ |
| **HMR çƒ­æ›´æ–°** | âœ… | âŒ | âŒ | âŒ |
| **Sourcemap** | âœ… | âŒ | âœ… | âœ… |
| **ä»£ç å‹ç¼©** | âŒ | âœ… | âŒ | âœ… |
| **æ—¥å¿—çº§åˆ«** | debug | warn | silent | info |
| **API åœ°å€** | localhost:8080 | api.example.com | localhost:3001 | staging-api.example.com |

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¼€å‘ç¯å¢ƒï¼ˆé»˜è®¤ï¼‰

```bash
# å¼€å‘æ¨¡å¼ï¼ˆä½¿ç”¨å¼€å‘ç¯å¢ƒé…ç½®ï¼‰
pnpm dev

# æˆ–æ˜¾å¼æŒ‡å®šç¯å¢ƒ
pnpm dev --environment development
```

**å¼€å‘ç¯å¢ƒç‰¹ç‚¹ï¼š**
- âœ… è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
- âœ… å¯ç”¨ HMR çƒ­æ›´æ–°
- âœ… ç”Ÿæˆ sourcemap ä¾¿äºè°ƒè¯•
- âœ… ä¸å‹ç¼©ä»£ç ï¼Œæ„å»ºé€Ÿåº¦å¿«
- âœ… è¯¦ç»†æ—¥å¿—è¾“å‡º
- ğŸ“ ç«¯å£ï¼š5174ï¼ˆå¼€å‘æœåŠ¡å™¨ï¼‰ï¼Œ4174ï¼ˆé¢„è§ˆæœåŠ¡å™¨ï¼‰
- ğŸ“¦ è¾“å‡ºç›®å½•ï¼š`dist-dev`
- ğŸ“‹ é…ç½®é¢æ¿ï¼šæ˜¾ç¤ºï¼ˆæ”¯æŒå®æ—¶æ›´æ–°ï¼‰

### ç”Ÿäº§ç¯å¢ƒ

```bash
# ç”Ÿäº§æ„å»º
pnpm build

# æˆ–æ˜¾å¼æŒ‡å®šç¯å¢ƒ
pnpm build --environment production

# é¢„è§ˆç”Ÿäº§æ„å»ºç»“æœ
pnpm preview
```

**ç”Ÿäº§ç¯å¢ƒç‰¹ç‚¹ï¼š**
- âœ… ä»£ç å‹ç¼©å’Œä¼˜åŒ–
- âœ… ä¸ç”Ÿæˆ sourcemapï¼ˆå‡å°‘ä½“ç§¯ï¼‰
- âœ… ä»£ç åˆ†å‰²ä¼˜åŒ–
- âœ… æ–‡ä»¶ååŒ…å« hashï¼ˆä¾¿äºç¼“å­˜ï¼‰
- âš ï¸ åªæ˜¾ç¤ºè­¦å‘Šå’Œé”™è¯¯æ—¥å¿—
- ğŸ“ ç«¯å£ï¼š5175ï¼ˆå¼€å‘æœåŠ¡å™¨ï¼‰ï¼Œ4175ï¼ˆé¢„è§ˆæœåŠ¡å™¨ï¼‰
- ğŸ“¦ è¾“å‡ºç›®å½•ï¼š`dist-prod`
- ğŸ“‹ é…ç½®é¢æ¿ï¼šéšè—

### æµ‹è¯•ç¯å¢ƒ

```bash
# æµ‹è¯•ç¯å¢ƒå¼€å‘
pnpm dev:test

# æµ‹è¯•ç¯å¢ƒæ„å»º
pnpm build:test

# é¢„è§ˆæµ‹è¯•æ„å»º
pnpm preview:test
```

**æµ‹è¯•ç¯å¢ƒç‰¹ç‚¹ï¼š**
- âœ… ä¿ç•™ sourcemap ä¾¿äºè°ƒè¯•
- âœ… ä¸å‹ç¼©ä»£ç ï¼ŒåŠ å¿«æ„å»º
- âœ… ä½¿ç”¨æµ‹è¯• API åœ°å€
- ğŸ”‡ é™é»˜æ¨¡å¼ï¼ˆæœ€å°‘æ—¥å¿—ï¼‰
- ğŸ“ ç«¯å£ï¼š5176ï¼ˆå¼€å‘æœåŠ¡å™¨ï¼‰ï¼Œ4176ï¼ˆé¢„è§ˆæœåŠ¡å™¨ï¼‰
- ğŸ“¦ è¾“å‡ºç›®å½•ï¼š`dist-test`
- ğŸ“‹ é…ç½®é¢æ¿ï¼šæ˜¾ç¤º

### é¢„å‘å¸ƒç¯å¢ƒ

```bash
# é¢„å‘å¸ƒç¯å¢ƒå¼€å‘
pnpm dev:staging

# é¢„å‘å¸ƒç¯å¢ƒæ„å»º
pnpm build:staging

# é¢„è§ˆé¢„å‘å¸ƒæ„å»º
pnpm preview:staging
```

**é¢„å‘å¸ƒç¯å¢ƒç‰¹ç‚¹ï¼š**
- âœ… æ¥è¿‘ç”Ÿäº§ç¯å¢ƒé…ç½®
- âœ… ä¿ç•™ sourcemap ä¾¿äºé—®é¢˜æ’æŸ¥
- âœ… å¯ç”¨ä»£ç å‹ç¼©
- âœ… ä½¿ç”¨é¢„å‘å¸ƒ API åœ°å€
- ğŸ“ ç«¯å£ï¼š5177ï¼ˆå¼€å‘æœåŠ¡å™¨ï¼‰ï¼Œ4177ï¼ˆé¢„è§ˆæœåŠ¡å™¨ï¼‰
- ğŸ“¦ è¾“å‡ºç›®å½•ï¼š`dist-staging`
- ğŸ“‹ é…ç½®é¢æ¿ï¼šæ˜¾ç¤º

## ğŸ“‹ å¯ç”¨è„šæœ¬å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | ç¯å¢ƒ | ç«¯å£ | è¾“å‡ºç›®å½• |
|------|------|------|------|---------|
| `pnpm dev` | å¼€å‘æ¨¡å¼ | development | 5174 | dist-dev |
| `pnpm dev:prod` | å¼€å‘æ¨¡å¼ï¼ˆç”Ÿäº§é…ç½®ï¼‰ | production | 5175 | dist-prod |
| `pnpm dev:test` | å¼€å‘æ¨¡å¼ï¼ˆæµ‹è¯•é…ç½®ï¼‰ | test | 5176 | dist-test |
| `pnpm dev:staging` | å¼€å‘æ¨¡å¼ï¼ˆé¢„å‘å¸ƒé…ç½®ï¼‰ | staging | 5177 | dist-staging |
| `pnpm build` | ç”Ÿäº§æ„å»º | production | - | dist-prod |
| `pnpm build:dev` | å¼€å‘æ„å»º | development | - | dist-dev |
| `pnpm build:test` | æµ‹è¯•æ„å»º | test | - | dist-test |
| `pnpm build:staging` | é¢„å‘å¸ƒæ„å»º | staging | - | dist-staging |
| `pnpm preview` | é¢„è§ˆç”Ÿäº§æ„å»º | production | 4175 | dist-prod |
| `pnpm preview:dev` | é¢„è§ˆå¼€å‘æ„å»º | development | 4174 | dist-dev |
| `pnpm preview:test` | é¢„è§ˆæµ‹è¯•æ„å»º | test | 4176 | dist-test |
| `pnpm preview:staging` | é¢„è§ˆé¢„å‘å¸ƒæ„å»º | staging | 4177 | dist-staging |

## ğŸ”„ App é…ç½®å®æ—¶æ›´æ–°æµ‹è¯•

### ä½¿ç”¨é…ç½®é¢æ¿

åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œé¦–é¡µå¤´éƒ¨ä¼šæ˜¾ç¤ºä¸€ä¸ªé…ç½®ä¿¡æ¯é¢æ¿ï¼Œå±•ç¤ºå½“å‰çš„åº”ç”¨é…ç½®ã€‚è¿™ä¸ªé¢æ¿æ”¯æŒå®æ—¶æ›´æ–°ï¼š

1. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**ï¼š
   ```bash
   pnpm dev
   ```

2. **æŸ¥çœ‹é…ç½®é¢æ¿**ï¼š
   - æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5174`
   - åœ¨é¡µé¢å¤´éƒ¨å¯ä»¥çœ‹åˆ°é…ç½®ä¿¡æ¯é¢æ¿
   - é¢æ¿æ˜¾ç¤ºå½“å‰ç¯å¢ƒçš„é…ç½®ä¿¡æ¯

3. **æµ‹è¯•å®æ—¶æ›´æ–°**ï¼š
   - ä¿®æ”¹ `.ldesign/app.config.development.ts` æ–‡ä»¶
   - ä¿å­˜æ–‡ä»¶åï¼Œé…ç½®ä¼šè‡ªåŠ¨æ›´æ–°
   - é…ç½®é¢æ¿ä¼šå®æ—¶æ˜¾ç¤ºæ–°çš„é…ç½®å€¼
   - é¢æ¿å³ä¸Šè§’ä¼šæ˜¾ç¤ºæ›´æ–°æ¬¡æ•°

### åœ¨ä»£ç ä¸­ä½¿ç”¨é…ç½®

```vue
<script setup lang="ts">
import { useAppConfig } from '@ldesign/launcher/client/vue'

// ä½¿ç”¨ useAppConfig è·å–é…ç½®ï¼ˆæ”¯æŒ HMR çƒ­æ›´æ–°ï¼‰
const { config, environment } = useAppConfig()

// config æ˜¯å“åº”å¼çš„ï¼Œé…ç½®æ›´æ–°æ—¶ä¼šè‡ªåŠ¨æ›´æ–°
console.log('åº”ç”¨åç§°:', config.value.app.name)
console.log('API åœ°å€:', config.value.api.baseUrl)
console.log('å½“å‰ç¯å¢ƒ:', environment.value.mode)
</script>
```

### é…ç½®ç»“æ„

App é…ç½®åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š

```typescript
{
  app: {
    name: string        // åº”ç”¨åç§°
    version: string     // ç‰ˆæœ¬å·
    description: string // æè¿°
  },
  api: {
    baseUrl: string     // API åŸºç¡€åœ°å€
    timeout: number     // è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  },
  features: {
    enableAnalytics: boolean  // æ˜¯å¦å¯ç”¨åˆ†æç»Ÿè®¡
    enableDebug: boolean     // æ˜¯å¦å¯ç”¨è°ƒè¯•æ¨¡å¼
  },
  theme: {
    primaryColor: string  // ä¸»è‰²è°ƒ
    mode: string          // ä¸»é¢˜æ¨¡å¼ï¼ˆlight/darkï¼‰
  },
  dev?: {                 // å¼€å‘é…ç½®ï¼ˆå¯é€‰ï¼‰
    showConfigPanel: boolean  // æ˜¯å¦æ˜¾ç¤ºé…ç½®é¢æ¿
    logLevel: string          // æ—¥å¿—çº§åˆ«
    enableHotReload: boolean  // æ˜¯å¦å¯ç”¨çƒ­æ›´æ–°
  }
}
```

## âš™ï¸ é…ç½®è¯´æ˜

### é…ç½®åˆå¹¶è§„åˆ™

ç¯å¢ƒé…ç½®ä¼šä¸åŸºç¡€é…ç½®è¿›è¡Œ**æ·±åº¦åˆå¹¶**ï¼š

- ç¯å¢ƒé…ç½®çš„å±æ€§ä¼šè¦†ç›–åŸºç¡€é…ç½®çš„åŒåå±æ€§
- åµŒå¥—å¯¹è±¡ä¼šé€’å½’åˆå¹¶
- æ•°ç»„ä¼šè¢«å®Œå…¨æ›¿æ¢ï¼ˆä¸åˆå¹¶ï¼‰

### ç¯å¢ƒç‰¹å®šé…ç½®

æ¯ä¸ªç¯å¢ƒé…ç½®æ–‡ä»¶å¯ä»¥è¦†ç›–ä»¥ä¸‹é…ç½®ï¼š

**Launcher é…ç½®**ï¼š
- **server**: å¼€å‘æœåŠ¡å™¨é…ç½®ï¼ˆç«¯å£ã€ä¸»æœºã€ä»£ç†ç­‰ï¼‰
- **preview**: é¢„è§ˆæœåŠ¡å™¨é…ç½®ï¼ˆç«¯å£ã€ä¸»æœºç­‰ï¼‰
- **build**: æ„å»ºé…ç½®ï¼ˆè¾“å‡ºç›®å½•ã€å‹ç¼©ã€sourcemap ç­‰ï¼‰
- **define**: å…¨å±€å˜é‡å®šä¹‰ï¼ˆAPI åœ°å€ã€ç¯å¢ƒæ ‡è¯†ç­‰ï¼‰
- **launcher**: Launcher ç‰¹å®šé…ç½®ï¼ˆæ—¥å¿—çº§åˆ«ã€ç¼“å­˜ã€ä¼˜åŒ–ç­‰ï¼‰
- **cacheDir**: Vite ç¼“å­˜ç›®å½•

**App é…ç½®**ï¼š
- **app**: åº”ç”¨ä¿¡æ¯ï¼ˆåç§°ã€ç‰ˆæœ¬ã€æè¿°ï¼‰
- **api**: API é…ç½®ï¼ˆåœ°å€ã€è¶…æ—¶æ—¶é—´ï¼‰
- **features**: åŠŸèƒ½ç‰¹æ€§ï¼ˆåˆ†æã€è°ƒè¯•ï¼‰
- **theme**: ä¸»é¢˜é…ç½®ï¼ˆé¢œè‰²ã€æ¨¡å¼ï¼‰
- **dev**: å¼€å‘é…ç½®ï¼ˆé¢æ¿æ˜¾ç¤ºã€æ—¥å¿—çº§åˆ«ã€çƒ­æ›´æ–°ï¼‰

### è‡ªå®šä¹‰é…ç½®

å¦‚æœéœ€è¦ä¿®æ”¹æŸä¸ªç¯å¢ƒçš„é…ç½®ï¼Œç›´æ¥ç¼–è¾‘å¯¹åº”çš„é…ç½®æ–‡ä»¶å³å¯ï¼š

**Launcher é…ç½®**ï¼š
- å¼€å‘ç¯å¢ƒï¼š`.ldesign/launcher.config.development.ts`
- ç”Ÿäº§ç¯å¢ƒï¼š`.ldesign/launcher.config.production.ts`
- æµ‹è¯•ç¯å¢ƒï¼š`.ldesign/launcher.config.test.ts`
- é¢„å‘å¸ƒç¯å¢ƒï¼š`.ldesign/launcher.config.staging.ts`

**App é…ç½®**ï¼š
- å¼€å‘ç¯å¢ƒï¼š`.ldesign/app.config.development.ts`
- ç”Ÿäº§ç¯å¢ƒï¼š`.ldesign/app.config.production.ts`
- æµ‹è¯•ç¯å¢ƒï¼š`.ldesign/app.config.test.ts`
- é¢„å‘å¸ƒç¯å¢ƒï¼š`.ldesign/app.config.staging.ts`

### ä¿®æ”¹ç«¯å£å’Œè¾“å‡ºç›®å½•

æ¯ä¸ªç¯å¢ƒé…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£å’Œè¾“å‡ºç›®å½•éƒ½å¯ä»¥ç‹¬ç«‹é…ç½®ï¼š

```typescript
// ä¿®æ”¹å¼€å‘ç¯å¢ƒç«¯å£
server: {
  port: 3000, // ä¿®æ”¹ä¸ºä½ æƒ³è¦çš„ç«¯å£
}

// ä¿®æ”¹å¼€å‘ç¯å¢ƒè¾“å‡ºç›®å½•
build: {
  outDir: 'dist-custom', // ä¿®æ”¹ä¸ºä½ æƒ³è¦çš„ç›®å½•å
}
```

## ğŸ” è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„é…ç½®

```bash
# æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°åŠ è½½çš„é…ç½®æ–‡ä»¶
pnpm dev --debug
```

### éªŒè¯é…ç½®

```bash
# æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
pnpm build --dry-run
```

### æŸ¥çœ‹æ„å»ºè¾“å‡º

æ„å»ºå®Œæˆåï¼Œå¯ä»¥åœ¨å¯¹åº”çš„è¾“å‡ºç›®å½•æŸ¥çœ‹æ„å»ºç»“æœï¼š

- å¼€å‘ç¯å¢ƒï¼š`dist-dev/`
- ç”Ÿäº§ç¯å¢ƒï¼š`dist-prod/`
- æµ‹è¯•ç¯å¢ƒï¼š`dist-test/`
- é¢„å‘å¸ƒç¯å¢ƒï¼š`dist-staging/`

### æµ‹è¯•é…ç½®å®æ—¶æ›´æ–°

1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š`pnpm dev`
2. æ‰“å¼€æµè§ˆå™¨æŸ¥çœ‹é…ç½®é¢æ¿
3. ä¿®æ”¹ `.ldesign/app.config.development.ts` æ–‡ä»¶
4. ä¿å­˜æ–‡ä»¶ï¼Œè§‚å¯Ÿé…ç½®é¢æ¿æ˜¯å¦å®æ—¶æ›´æ–°
5. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ï¼Œåº”è¯¥èƒ½çœ‹åˆ°é…ç½®æ›´æ–°æ—¥å¿—

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Launcher å¤šç¯å¢ƒé…ç½®æŒ‡å—](../../../../tools/launcher/docs/guide/environment-config.md)
- [é…ç½®æ–‡ä»¶å‚è€ƒ](../../../../tools/launcher/docs/guide/config-reference.md)
- [App é…ç½®ä½¿ç”¨æŒ‡å—](../../../../tools/launcher/docs/app-config-migration.md)


